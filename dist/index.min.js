"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Fangdajin=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.container=document.querySelector(e.el),this.areaRectWidth=e.areaWidth||250,this.areaRectHeight=e.areaHeight||300,this.viewWidth=e.viewWidth||this.areaRectWidth,this.viewHeight=e.viewHeight||this.areaRectHeight,this.largeSize=e.largeSize||2,this.img=null,this.canvas=null,this.ctx=null,this.areaRect=null,this.sideCanvas=null,this.sideCtx=null}return _createClass(t,[{key:"init",value:function(){if(!this.container)throw new Error("请检查是否设定 el 属性");this.container.style.position="relative",this.generateCanvas(),this.generateAreaRect(),this.generateSideCanvas(),this.drawImage(),this.addEventListener()}},{key:"generateCanvas",value:function(){var e=document.createElement("canvas");e.width=this.getElementWidth(this.container),e.height=this.getElementHeight(this.container),this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.container.append(this.canvas)}},{key:"generateAreaRect",value:function(){var e=document.createElement("div");e.style.backgroundColor="rgba(0, 0, 0, 0.5)",e.style.position="absolute",e.style.display="none",e.style.width=this.areaRectWidth+"px",e.style.height=this.areaRectHeight+"px",this.areaRect=e,document.body.append(this.areaRect)}},{key:"generateSideCanvas",value:function(){var e=document.createElement("canvas");e.width=this.viewWidth,e.height=this.viewHeight,e.style.position="absolute",e.style.top=0,e.style.right="-"+this.viewWidth+"px",this.sideCanvas=e,this.container.append(this.sideCanvas),this.sideCtx=this.sideCanvas.getContext("2d")}},{key:"drawImage",value:function(){var e=this,t=new Image;t.src=this.container.getAttribute("data-img-src"),t.addEventListener("load",function(){e.ctx.drawImage(e.img,0,0)}),this.img=t}},{key:"addEventListener",value:function(){var h=this;document.addEventListener("mousemove",function(e){var t=e.clientX,i=e.clientY,a=h.getElementWidth(h.container),n=h.getElementHeight(h.container),r=h.container.getBoundingClientRect().top,s=r+n,c=h.container.getBoundingClientRect().left,e=c+a;c<=t&&t<=e&&r<=i&&i<=s&&(n=i-150,a=t-125,t<c+h.areaRectWidth/2?a=c:t>e-h.areaRectWidth/2&&(a=e-h.areaRectWidth),i<r+h.areaRectHeight/2?n=r:i>s-h.areaRectHeight/2&&(n=s-h.areaRectHeight),n+=window.scrollY,a+=window.scrollX,h.areaRect.style.display="block",h.areaRect.style.top=n+"px",h.areaRect.style.left=a+"px",r=n-r-window.scrollY,c=a-c-window.scrollX,h.sideCtx.clearRect(0,0,h.areaRectWidth,h.areaRectHeight),h.sideCtx.drawImage(h.canvas,c,r,h.areaRectWidth,h.areaRectHeight,-1*(h.areaRectWidth*h.largeSize-h.viewWidth)/2,-1*(h.areaRectHeight*h.largeSize-h.viewHeight)/2,h.areaRectWidth*h.largeSize,h.areaRectHeight*h.largeSize))})}},{key:"getElementWidth",value:function(e){return Number(window.getComputedStyle(e).width.split("px")[0])}},{key:"getElementHeight",value:function(e){return Number(window.getComputedStyle(e).height.split("px")[0])}}]),t}();try{exports&&(exports.default=Fangdajin)}catch(e){}